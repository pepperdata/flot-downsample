(function(g){var e=Math.floor,b=Math.abs;function f(m){var k=[];var n=[];for(var l=0;l<m.length;l++){var j=m[l];if(j){n.push(j)}else{k.push(n);k.push([null]);n=[]}}k.push(n);return k}function a(C,o){var w=C.length;if(o>=w||o===0){return C}var z=[],v=0;var D=(w-2)/(o-2);var B=0,r,s,y,j;z[v++]=C[B];for(var x=0;x<o-2;x++){var n=0,l=0,p=e((x+1)*D)+1,u=e((x+2)*D)+1;u=u<w?u:w;var t=u-p;for(;p<u;p++){n+=C[p][0]*1;l+=C[p][1]*1}n/=t;l/=t;var q=e((x+0)*D)+1,A=e((x+1)*D)+1;var m=C[B][0]*1,k=C[B][1]*1;s=y=-1;for(;q<A;q++){y=b((m-n)*(C[q][1]-k)-(m-C[q][0])*(l-k))*0.5;if(y>s){s=y;r=C[q];j=q}}z[v++]=r;B=j}z[v++]=C[w-1];return z}function d(q,m){var k=f(m.data);var p=[];for(var l=0;l<k.length;l++){var o=k[l];if(o&&o[0]!==null&&o){var j=o.length/m.data.length;var n=Math.ceil(m.downsample.threshold*j);o=a(o,n)}p=p.concat(o)}m.data=p}var c={series:{downsample:{threshold:1000}}};function h(i){i.hooks.processRawData.push(d)}g.plot.plugins.push({init:h,options:c,name:"downsample",version:"1.0"})})(jQuery);